# 组件示例编写提示词

本提示词用于编写遵循特定目录结构规范的 React 项目组件示例。

## 1. 目录结构规范

### 项目目录布局

```
{PROJECT_ROOT}/
├── src/                      # 源代码目录
│   └── components/           # 组件源代码
│       ├── ComponentA/       # 单个组件目录
│       ├── ComponentB/       # 带子组件的目录
│       │   ├── Sub1/
│       │   ├── Sub2/
│       │   └── index.js
│       └── ...
├── doc/                      # 文档及示例目录（所有组件共用）
│   ├── example.json          # 示例配置文件（核心）
│   ├── api.md                # 组件API文档
│   ├── summary.md            # 组件简要描述
│   ├── base.js               # 基础示例代码
│   ├── component-a.js        # ComponentA示例
│   ├── component-b.js        # ComponentB主组件示例
│   ├── component-b-sub1.js   # ComponentB子组件Sub1示例
│   ├── component-b-sub2.js   # ComponentB子组件Sub2示例
│   └── style.scss            # 示例样式（可选）
└── package.json              # 项目配置文件
```

### 示例文件规则

**重要**：所有组件的示例文件都统一放在项目根目录的 `doc/` 中，而不是在每个组件目录下创建单独的 `doc/` 目录。

- 单个组件：使用组件名的小写短横线形式命名示例文件，如 `component-a.js`
- 带子组件的组件：主组件示例使用组件名，子组件示例使用组件名加子组件名，如 `component-b.js`、`component-b-sub1.js`

### 项目配置变量

在编写示例时需要替换以下变量：

| 变量名 | 说明 | 示例值 |
|--------|------|--------|
| `{PACKAGE_NAME}` | 从 package.json 的 name 字段获取 | `@kne/react-file` |
| `{PROJECT_NAME}` | 项目名称，用于 getPublicPath | `react-file` |
| `{LIB_NAME}` | 组件库名称，通常是驼峰形式 | `ReactFile` |

## 2. example.json 配置结构

所有组件的示例配置统一在 `doc/example.json` 中管理：

```json
{
  "isFull": true,
  "list": [
    {
      "title": "ComponentA",
      "description": "组件A的描述",
      "code": "./component-a.js",
      "scope": [
        {
          "name": "_{LIB_NAME}",
          "packageName": "{PACKAGE_NAME}",
          "importStatement": "import * as _{LIB_NAME} from \"{PACKAGE_NAME}\""
        },
        {
          "packageName": "{PACKAGE_NAME}/dist/index.css"
        },
        {
          "name": "antd",
          "packageName": "antd"
        },
        {
          "name": "remoteLoader",
          "packageName": "@kne/remote-loader"
        }
      ]
    },
    {
      "title": "ComponentB",
      "description": "组件B主组件",
      "code": "./component-b.js",
      "scope": []
    },
    {
      "title": "ComponentB-Sub1",
      "description": "组件B子组件Sub1",
      "code": "./component-b-sub1.js",
      "scope": []
    }
  ]
}
```

## 3. 示例代码规范

### 导入方式

- 使用 `scope` 中声明的变量名：`const { FilePreview } = _{LIB_NAME};`
- 工具包引用：`const { createWithRemoteLoader, getPublicPath } = remoteLoader;`

### 标准示例模板（需要 PureGlobal 模拟数据）

```javascript
const { YourComponent } = _{LIB_NAME};
const { createWithRemoteLoader, getPublicPath } = remoteLoader;

const BaseExample = createWithRemoteLoader({
  modules: ['components-core:Global@PureGlobal', 'components-core:InfoPage']
})(({ remoteModules }) => {
  const [PureGlobal, InfoPage] = remoteModules;
  return (
    <PureGlobal preset={{
      ajax: async api => {
        return { data: { code: 0, data: api.loader() } };
      },
      apis: {
        file: {
          staticUrl: getPublicPath('{PROJECT_NAME}') || window.PUBLIC_URL,
          getUrl: {
            loader: async ({ params }) => {
              // 模拟数据
              return 'mock-url';
            }
          }
        }
      }
    }}>
      <InfoPage>
        <InfoPage.Part title="示例标题">
          <YourComponent prop="value" />
        </InfoPage.Part>
      </InfoPage>
    </PureGlobal>
  );
});

render(<BaseExample />);
```

### 简化示例模板（无需远程加载）

```javascript
const { YourComponent } = _{LIB_NAME};
const { Flex, Switch } = antd;
const { useState } = React;

const BaseExample = () => {
  const [state, setState] = useState(false);
  return (
    <Flex vertical gap={12}>
      <YourComponent prop={value} />
    </Flex>
  );
};

render(<BaseExample />);
```

## 4. scope 依赖声明规则

| 场景 | name | packageName | importStatement（可选） |
|------|------|-------------|------------------------|
| 项目组件 | `_{LIB_NAME}` | `{PACKAGE_NAME}` | `import * as _{LIB_NAME} from "{PACKAGE_NAME}"` |
| 样式文件 | - | `{PACKAGE_NAME}/dist/index.css` | - |
| 远程加载器 | `remoteLoader` | `@kne/remote-loader` | - |
| Antd组件 | `antd` | `antd` | - |
| React原生 | `React` | - | -（无需声明） |

## 5. API文档编写

`doc/api.md` 中包含所有组件的API文档，使用表格格式：

```markdown
### 组件名称

组件描述

#### 属性

| 属性 | 类型 | 默认值 | 描述 |
|------|------|-------|------|
| propName | string | - | 属性描述 |
```

## 6. 数据模拟

在示例中使用 PureGlobal 的 preset 模拟数据：

```javascript
apis: {
  file: {
    staticUrl: getPublicPath('{PROJECT_NAME}') || window.PUBLIC_URL,
    getUrl: {
      loader: async ({ params }) => {
        // 根据 params 返回对应的 mock 数据
        const urlMap = {
          1: '/mock/example.png',
          2: '/mock/example.pdf'
        };
        return new Promise(resolve => {
          setTimeout(() => {
            resolve(urlMap[params.id]);
          }, 500);
        });
      }
    }
  }
}
```

## 7. 组件导出规范

在组件的主入口 `index.js` 中，需要导出所有子组件：

```javascript
export { default } from './MainComponent';
export { default as SubComponent1 } from './SubComponent1';
export { default as SubComponent2 } from './SubComponent2';
```

在示例中通过解构引用：

```javascript
const { MainComponent, SubComponent1, SubComponent2 } = _{LIB_NAME};
```

## 8. 使用说明

### 创建新组件示例步骤

1. 在 `src/components/` 下创建或编辑组件
2. 在 `doc/example.json` 中添加示例配置
3. 在 `doc/` 目录下创建对应的 `.js` 示例文件
4. 在 `doc/api.md` 中添加组件API文档（如果是新组件）
5. 在组件的 `index.js` 中确保正确导出

### 变量替换示例

假设项目 `package.json` 中配置为：

```json
{
  "name": "@your-org/your-project"
}
```

则变量值为：

- `{PACKAGE_NAME}` → `@your-org/your-project`
- `{PROJECT_NAME}` → `your-project`
- `{LIB_NAME}` → `YourProject`

实际使用时需要替换为：

```json
{
  "name": "_YourProject",
  "packageName": "@your-org/your-project",
  "importStatement": "import * as _YourProject from \"@your-org/your-project\""
}
```

```javascript
const { YourComponent } = _YourProject;
const { createWithRemoteLoader, getPublicPath } = remoteLoader;

// ...
staticUrl: getPublicPath('your-project') || window.PUBLIC_URL,
```

## 9. 项目参考

本项目的示例文件位于 `doc/` 目录：

- `doc/example.json` - 所有组件的示例配置
- `doc/api.md` - 所有组件的API文档
- `doc/preview.js` - FilePreview 组件示例（包含多种预览类型）
- `doc/file-list.js` - FileList 组件示例
- `doc/download.js` - Download 组件示例
- `doc/markdown-preview.js` - MarkdownPreview 组件示例
